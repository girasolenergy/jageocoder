# jageocoder 検索オプション

この文書では、検索時のオプション設定について説明します。

## 検索オプションの設定

検索オプションを `jageocoder.set_search_config()` で設定できます。

> ただし `jageocoder.search()` を実行すると、結果のフォーマットが
> 最適解しか表現できないため、実行前に `best_only=True` をセットします。

- aza_skip: 小字の省略方法（None, True, False）
    - None: 省略するかどうか自動的に判定します
    - True: 常に省略します
    - False: 常に省略しません（デフォルト）
- best_only: 最適解のみ返すかどうか（True, False）
    - True: もっとも長く一致した候補だけを返します（デフォルト）
    - False: 一部でも一致した候補は全て返します
- target_area: 検索する範囲（文字列のリスト）
    - 空リスト: 全国の住所から検索します（デフォルト）
    - 都道府県名、市区町村名、JISコード: いずれかの要素と一致する地域の住所を検索します。
    たとえば `["東京都", "神奈川県"]` をセットした場合、
    東京都または神奈川県内の住所を検索します。

## 利用例

「東京都」の「落合1-15-2」の経緯度を調べたいとします。

市区町村名が分からないので「落合1-15-2」で検索すると、
デフォルト設定のままでは壬生町（栃木県）と広島市安佐北区（広島県）の
候補が返ってきて、東京都の候補は見つかりません。

```python
>>> jageocoder.searchNode('落合1-15-2')
[{"node":{"id": 6357006, "name": "2号", "x": 139.820208258, "y": 36.450565089, "level": 8, "note": null, "fullname": ["栃木県", "下都賀郡", "壬生町", "落合", "一丁目", "15番", "2号"]},
  "matched": "落合1-15-2"},
 {"node": {"id": 32344637, "name": "2号", "x": 132.510432116, "y": 34.473211622, "level": 8, "note": null, "fullname": ["広島県", "広島市", "安佐北区", "落合", "一丁目", "15番", "2号"]},
 "matched": "落合1-15-2"}]
```

検索対象が東京都内であることが分かっているので、 `target_area` を
「東京都」に設定して実行すると、多摩市の候補が得られます。

```python
>>> jageocoder.set_search_config(target_area=['東京都'])
>>> jageocoder.searchNode('落合1-15-2')
[{"node": {"id": 12061106, "name": "15番地", "x": 139.428969, "y": 35.625779, "level": 7, "note": null, "fullname": ["東京都", "多摩市", "落合", "一丁目", "15番地"]},
  "matched": "落合1-15-"}]
```

この候補は "落合1-15-" までしか住所辞書に登録されていないため、
検索範囲を指定しないと "落合1-15-2" まで一致する壬生町や
安佐北区の候補の方が最適解として選択されます。

または `best_only` を False に設定すると、全ての候補が返りますので、
その中から東京都の候補を探すこともできます。

```python
>>> jageocoder.set_search_config(target_area=[], best_only=False)
>>> jageocoder.searchNode('落合1-15-2')
[{"node": {"id": 6357006, "name": "2号", "x": 139.820208258, "y": 36.450565089, "level": 8, "note": null, "fullname": ["栃木県", "下都賀郡", "壬生町", "落合", "一丁目", "15番", "2号"]},
  "matched": "落合1-15-2"},
 {"node": {"id": 32344637, "name": "2号", "x": 132.510432116, "y": 34.473211622, "level": 8, "note": null, "fullname": ["広島県", "広島市", "安佐北区", "落合", "一丁目", "15番", "2号"]},
  "matched": "落合1-15-2"},
 {"node": {"id": 3388380, "name": "15番", "x": 140.791677, "y": 38.270326, "level": 7, "note": null, "fullname": ["宮城県", "仙台市", "青葉区", "落合", "一丁目", "15番"]},
  "matched": "落合1-15-"},
 {"node": {"id": 12061106, "name": "15番地", "x": 139.428969, "y": 35.625779, "level": 7, "note": null, "fullname": ["東京都", "多摩市", "落合", "一丁目", "15番地"]},
  "matched": "落合1-15-"},
 {"node": {"id": 4255304, "name": "1番地", "x": 140.344313, "y": 38.27976, "level": 7, "note": null, "fullname": ["山形県", "山形市", "落合町", "1番地"]},
  "matched": "落合1-"},
...
 {"node": {"id": 30914942, "name": "落合町", "x": 133.752351, "y": 35.018191, "level": 3, "note": "jisx0402:33582", "fullname": ["岡山県", "真庭郡", "落合町"]},
  "matched": "落合"}]
```

## 検索オプションの取得

検索オプションの設定を取得したい場合は `jageocoder.get_search_config()` を
呼ぶと一覧が返ります。

```python
>>> jageocoder.get_search_config()
{'debug': False, 'aza_skip': False, 'best_only': False, 'target_area': []}
```
